<script src="scripts/tmi.min.js"></script>
<script src="botlogin.js"></script>

<!-- <script src="scripts/ss.js"></script>-->
<!-- When using ss.js instead of the sourcefiles below the error "propImage is not defined" happens. Because I can't fix it myself I'm including everything below instead. Not stupid if it works right? -->
<script src="scripts/src/Animator.js"></script>
<script src="scripts/src/ClubBalance.js"></script>
<script src="scripts/src/Draw.js"></script>
<script src="scripts/src/Hands.js"></script>
<script src="scripts/src/HeadBounce.js"></script>
<script src="scripts/src/Juggler.js"></script>
<script src="scripts/src/Prop.js"></script>
<script src="scripts/src/Props.js"></script>
<script src="scripts/src/Throw.js"></script>


<script>

			let options = {
				fps: 60,
				throwsPerSecond: 2,
				exportGif: false,
				backgroundColour: '#FFFFFF',
				controls: false,
				debug: true,
			};
			
			let animator;

// Frontend
document.write("<canvas id='stage' width='280', height='640' style='background: rgba(0,0,0,0.6);'></canvas>");

// Create a client with our options
const client = new tmi.client(opts);

// Register our event handlers (defined below)
client.on('connected', onConnectedHandler);

// Connect to Twitch:
client.connect();

// Called every time the bot connects to Twitch chat
function onConnectedHandler (addr, port) {
  console.log(`* Connected to ${addr}:${port}`);
}

//Siteswap command
client.on('message', (channel, tags, message, self) => {
    if(self || message[0] !== '!') return;
    let parameters = message.split(' ').filter(n => n);
    let command = parameters.shift().slice(1).toLowerCase();
    if(command === 'ss') {
			canvasId = "stage";
			siteswap = `${parameters[0]}`;
			//const options = {propType: `${parameters[1]}`}
			const options = parameters[1] ? {propType: parameters[1]} : {}

				//Emote prop
				if (tags.emotes !== null) {
					emoteID = `${Object.keys(tags.emotes)[0]}`;
					propImage.src = 'https://static-cdn.jtvnw.net/emoticons/v1/' + emoteID + '/2.0';
				}
				
			animator = new SiteswapJS(canvasId, siteswap, options);
			animator.start();
    }
});
</script>
